
import openpyxl
import os

# Создаем новую книгу Excel
wb = openpyxl.Workbook()
ws = wb.active
ws.title = "Импорт Работ"

# Заголовки столбцов
headers = ["Название", "Категория", "ед. изм.", "базовая цена", "Клиентская цена"]
ws.append(headers)

# Данные для импорта
data = [
    # 1. Существующая категория, новая работа
    ("Укладка ламината", "Отделочные работы", "м2", 250, 400),
    # 2. Новая категория и новая работа
    ("Монтаж электрощитка", "Электромонтажные работы", "шт", 1500, 2500),
    # 3. Существующая работа для теста обновления (предполагаем, что "Вывоз грунта" уже есть)
    ("Вывоз грунта", "Земляные работы", "м3", 550, 700),
    # 4. Еще одна работа в новой категории
    ("Прокладка кабеля", "Электромонтажные работы", "м.п.", 80, 150),
    # 5. Строка с пропущенной ценой для теста обработки ошибок
    ("Покраска потолка", "Отделочные работы", "м2", None, 200),
    # 6. Пустая строка для теста
    (None, None, None, None, None),
    # 7. Еще одна валидная работа
    ("Монтаж подоконника", "Отделочные работы", "м.п.", 300, 500),
]

for row in data:
    ws.append(row)

# Сохраняем файл в текущей директории скрипта
file_path = os.path.join(os.path.dirname(__file__), "works_import_example.xlsx")
wb.save(file_path)

print(f"Тестовый файл '{file_path}' успешно создан.")
